"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[881],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,g=u["".concat(p,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(g,i(i({ref:t},d),{},{components:n})):a.createElement(g,i({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},85768:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const o={sidebar_position:5,title:"dbt"},i=void 0,l={unversionedId:"integrations/dbt",id:"integrations/dbt",title:"dbt",description:"dbt (data build tool) is a powerful transformation engine. It operates on data already within a warehouse, making it easy for data engineers to build complex pipelines from the comfort of their laptops. While it doesn\u2019t perform extraction and loading of data, it\u2019s extremely powerful at transformations.",source:"@site/docs/integrations/dbt.md",sourceDirName:"integrations",slug:"/integrations/dbt",permalink:"/docs/integrations/dbt",draft:!1,editUrl:"https://github.com/OpenLineage/docs/tree/main/docs/integrations/dbt.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"dbt"},sidebar:"tutorialSidebar",previous:{title:"Apache Flink",permalink:"/docs/integrations/flink"},next:{title:"Great Expectations",permalink:"/docs/integrations/great-expectations"}},p={},s=[{value:"How does dbt work with OpenLineage?",id:"how-does-dbt-work-with-openlineage",level:2},{value:"Preparing a dbt project for OpenLineage",id:"preparing-a-dbt-project-for-openlineage",level:2},{value:"Running dbt with OpenLineage",id:"running-dbt-with-openlineage",level:2},{value:"Where can I learn more?",id:"where-can-i-learn-more",level:2},{value:"Feedback",id:"feedback",level:2}],d={toc:s};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"dbt (data build tool) is a powerful transformation engine. It operates on data already within a warehouse, making it easy for data engineers to build complex pipelines from the comfort of their laptops. While it doesn\u2019t perform extraction and loading of data, it\u2019s extremely powerful at transformations."),(0,r.kt)("p",null,"To learn more about dbt, visit the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.getdbt.com"},"documentation site")," or run through the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.getdbt.com/tutorial/setting-up"},"getting started tutorial"),"."),(0,r.kt)("h2",{id:"how-does-dbt-work-with-openlineage"},"How does dbt work with OpenLineage?"),(0,r.kt)("p",null,"Fortunately, dbt already collects a lot of the data required to create and emit OpenLineage events. When it runs, it creates a ",(0,r.kt)("inlineCode",{parentName:"p"},"target/manifest.json")," file containing information about jobs and the datasets they affect, and a ",(0,r.kt)("inlineCode",{parentName:"p"},"target/run_results.json")," file containing information about the run-cycle. These files can be used to trace lineage and job performance. In addition, by using the ",(0,r.kt)("inlineCode",{parentName:"p"},"create catalog")," command, a user can instruct dbt to create a ",(0,r.kt)("inlineCode",{parentName:"p"},"target/catalog.json")," file containing information about dataset schemas."),(0,r.kt)("p",null,"These files contain everything needed to trace lineage. However, the ",(0,r.kt)("inlineCode",{parentName:"p"},"target/manifest.json")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"target/run_results.json")," files are only populated with comprehensive metadata after completion of a run-cycle. "),(0,r.kt)("p",null,"This integration is implemented as a wrapper script, ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt-ol"),", that calls ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt")," and, after the run has completed, collects information from the three json files and calls the OpenLineage API accordingly. For most users, enabling OpenLineage metadata collection can be accomplished by simply substituting ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt-ol")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt")," when performing a run."),(0,r.kt)("h2",{id:"preparing-a-dbt-project-for-openlineage"},"Preparing a dbt project for OpenLineage"),(0,r.kt)("p",null,"First, we need to install the integration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pip3 install openlineage-dbt\n")),(0,r.kt)("p",null,"Next, we specify where we want dbt to send OpenLineage events by setting the ",(0,r.kt)("inlineCode",{parentName:"p"},"OPENLINEAGE_URL")," environment variable. For example, to send OpenLineage events to a local instance of Marquez, use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"OPENLINEAGE_URL=http://localhost:5000\n")),(0,r.kt)("p",null,'Finally, we can optionally specify a namespace where the lineage events will be stored. For example, to use the namespace "dev":'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"OPENLINEAGE_NAMESPACE=dev\n")),(0,r.kt)("h2",{id:"running-dbt-with-openlineage"},"Running dbt with OpenLineage"),(0,r.kt)("p",null,"To run your dbt project with OpenLineage collection, simply replace ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt-ol"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"dbt-ol run\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt-ol")," wrapper supports all of the standard ",(0,r.kt)("inlineCode",{parentName:"p"},"dbt")," subcommands, and is safe to use as a substitutuon (i.e., in an alias). Once the run has completed, you will see output containing the number of events sent via the OpenLineage API:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Completed successfully\n\nDone. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2\nEmitted 4 openlineage events\n")),(0,r.kt)("h2",{id:"where-can-i-learn-more"},"Where can I learn more?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Watch ",(0,r.kt)("a",{parentName:"li",href:"https://youtu.be/7caHXLDKacg"},"a short demonstration of the integration in action"))),(0,r.kt)("h2",{id:"feedback"},"Feedback"),(0,r.kt)("p",null,"What did you think of this guide? You can reach out to us on ",(0,r.kt)("a",{parentName:"p",href:"http://bit.ly/OpenLineageSlack"},"slack")," and leave us feedback!"))}c.isMDXComponent=!0}}]);