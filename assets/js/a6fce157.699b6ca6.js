"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4180],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,f=d["".concat(p,".").concat(m)]||d[m]||c[m]||i;return n?a.createElement(f,o(o({ref:t},u),{},{components:n})):a.createElement(f,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},96783:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const i={sidebar_position:1,title:"Using the Airflow Integration"},o=void 0,l={unversionedId:"integrations/airflow/usage",id:"integrations/airflow/usage",title:"Using the Airflow Integration",description:"This page is about Airflow's external integration that works mainly for Airflow versions <2.7.",source:"@site/docs/integrations/airflow/usage.md",sourceDirName:"integrations/airflow",slug:"/integrations/airflow/usage",permalink:"/docs/integrations/airflow/usage",draft:!1,editUrl:"https://github.com/OpenLineage/docs/tree/main/docs/integrations/airflow/usage.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Using the Airflow Integration"},sidebar:"tutorialSidebar",previous:{title:"Apache Airflow",permalink:"/docs/integrations/airflow/"},next:{title:"Supported Airflow versions",permalink:"/docs/integrations/airflow/older"}},p={},s=[{value:"PREREQUISITES",id:"prerequisites",level:4},{value:"INSTALLATION",id:"installation",level:4},{value:"CONFIGURATION",id:"configuration",level:4},{value:"Environment Variables",id:"environment-variables",level:5},{value:"USAGE",id:"usage",level:4}],u={toc:s};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"This page is about Airflow's external integration that works mainly for Airflow versions <2.7.\n",(0,r.kt)("a",{parentName:"p",href:"https://airflow.apache.org/docs/apache-airflow-providers-openlineage/stable/index.html"},"If you're using Airflow 2.7+, look at native Airflow OpenLineage provider documentation."),"  ",(0,r.kt)("br",null),(0,r.kt)("br",null)," "),(0,r.kt)("p",{parentName:"admonition"},"The ongoing development and enhancements will be focused on the ",(0,r.kt)("inlineCode",{parentName:"p"},"apache-airflow-providers-openlineage")," package,\nwhile the ",(0,r.kt)("inlineCode",{parentName:"p"},"openlineage-airflow")," will primarily be updated for bug fixes. See ",(0,r.kt)("a",{parentName:"p",href:"/docs/integrations/airflow/older#supported-airflow-versions"},"all Airflow versions supported by this integration"))),(0,r.kt)("h4",{id:"prerequisites"},"PREREQUISITES"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.python.org/downloads"},"Python 3.8")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://pypi.org/project/apache-airflow"},"Airflow >= 2.1,<2.8"))),(0,r.kt)("p",null,"To use the OpenLineage Airflow integration, you'll need a running ",(0,r.kt)("a",{parentName:"p",href:"https://airflow.apache.org/docs/apache-airflow/stable/start.html"},"Airflow instance"),". You'll also need an OpenLineage-compatible ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/OpenLineage/OpenLineage#scope"},"backend"),"."),(0,r.kt)("h4",{id:"installation"},"INSTALLATION"),(0,r.kt)("p",null,"Before installing check ",(0,r.kt)("a",{parentName:"p",href:"/docs/integrations/airflow/older#supported-airflow-versions"},"supported Airflow versions"),"."),(0,r.kt)("p",null,"To download and install the latest ",(0,r.kt)("inlineCode",{parentName:"p"},"openlineage-airflow")," library run: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"openlineage-airflow\n")),(0,r.kt)("p",null,"You can also add ",(0,r.kt)("inlineCode",{parentName:"p"},"openlineage-airflow")," to your ",(0,r.kt)("inlineCode",{parentName:"p"},"requirements.txt")," for Airflow.  "),(0,r.kt)("p",null,"To install from source, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ python3 setup.py install\n")),(0,r.kt)("h4",{id:"configuration"},"CONFIGURATION"),(0,r.kt)("p",null,"Next, specify where you want OpenLineage to send events. "),(0,r.kt)("p",null,"We recommend configuring the client with an ",(0,r.kt)("inlineCode",{parentName:"p"},"openlineage.yml")," file that tells the client how to connect to an OpenLineage backend.",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("a",{parentName:"p",href:"/docs/client/python#configuration"},"See how to do it.")),(0,r.kt)("p",null,"The simplest option, limited to HTTP client, is to use the environment variables.\nFor example, to send OpenLineage events to a local instance of ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/MarquezProject/marquez"},"Marquez"),", use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"OPENLINEAGE_URL=http://localhost:5000\nOPENLINEAGE_ENDPOINT=api/v1/lineage # This is the default value when this variable is not set, it can be omitted in this example\nOPENLINEAGE_API_KEY=secret_token # This is only required if authentication headers are required, it can be omitted in this example\n")),(0,r.kt)("p",null,"To set up an additional configuration, or to send events to targets other than an HTTP server (e.g., a Kafka topic), ",(0,r.kt)("a",{parentName:"p",href:"/docs/client/python#configuration"},"configure a client.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"NOTE:"))," If you use a version of Airflow older than 2.3.0, ",(0,r.kt)("a",{parentName:"p",href:"/docs/integrations/airflow/older#airflow-21---22"},"additional configuration is required"),".")),(0,r.kt)("h5",{id:"environment-variables"},"Environment Variables"),(0,r.kt)("p",null,"The following environment variables are available specifically for the Airflow integration, in addition to ",(0,r.kt)("a",{parentName:"p",href:"/docs/client/python#environment-variables"},"Python client variables"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"),(0,r.kt)("th",{parentName:"tr",align:null},"Example"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OPENLINEAGE_AIRFLOW_DISABLE_SOURCE_CODE"),(0,r.kt)("td",{parentName:"tr",align:null},"Set to ",(0,r.kt)("inlineCode",{parentName:"td"},"False")," if you want source code of callables provided in PythonOperator or BashOperator ",(0,r.kt)("inlineCode",{parentName:"td"},"NOT")," to be included in OpenLineage events."),(0,r.kt)("td",{parentName:"tr",align:null},"False")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OPENLINEAGE_EXTRACTORS"),(0,r.kt)("td",{parentName:"tr",align:null},"The optional list of extractors class (as semi-colon separated string) in case you need to use custom extractors."),(0,r.kt)("td",{parentName:"tr",align:null},"full.path.to.ExtractorClass;full.path.to.AnotherExtractorClass")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OPENLINEAGE_NAMESPACE"),(0,r.kt)("td",{parentName:"tr",align:null},"The optional namespace that the lineage data belongs to. If not specified, defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"default"),"."),(0,r.kt)("td",{parentName:"tr",align:null},"my_namespace")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OPENLINEAGE_AIRFLOW_LOGGING"),(0,r.kt)("td",{parentName:"tr",align:null},"Logging level of OpenLineage client in Airflow (the OPENLINEAGE_CLIENT_LOGGING variable from python client has no effect here)."),(0,r.kt)("td",{parentName:"tr",align:null},"DEBUG")))),(0,r.kt)("p",null,"For backwards compatibility, ",(0,r.kt)("inlineCode",{parentName:"p"},"openlineage-airflow")," also supports configuration via\n",(0,r.kt)("inlineCode",{parentName:"p"},"MARQUEZ_NAMESPACE"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"MARQUEZ_URL")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"MARQUEZ_API_KEY")," variables, instead of standard\n",(0,r.kt)("inlineCode",{parentName:"p"},"OPENLINEAGE_NAMESPACE"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"OPENLINEAGE_URL")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"OPENLINEAGE_API_KEY"),".\nVariables with different prefix should not be mixed together."),(0,r.kt)("h4",{id:"usage"},"USAGE"),(0,r.kt)("p",null,"When enabled, the integration will:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"On TaskInstance ",(0,r.kt)("strong",{parentName:"li"},"start"),", collect metadata for each task."),(0,r.kt)("li",{parentName:"ul"},"Collect task input / output metadata (source, schema, etc.)."),(0,r.kt)("li",{parentName:"ul"},"Collect task run-level metadata (execution time, state, parameters, etc.)"),(0,r.kt)("li",{parentName:"ul"},"On TaskInstance ",(0,r.kt)("strong",{parentName:"li"},"complete"),", also mark the task as complete in Marquez.")))}c.isMDXComponent=!0}}]);